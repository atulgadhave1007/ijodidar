<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./static/style.css"> 
    <!-- REMOVE Bootstrap 4 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" ...>

    <!-- REMOVE Bootstrap 5.3.0 (older version) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- REMOVE DUPLICATE 5.3.3 link (if repeated) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" ...> <!-- should only appear once -->

    <title>IJodidar</title>
    
</head>
<body class="text-bg-white" style="width: 99%;">
    <header class="navbar navbar-expand-lg text-body-dark bg-white sticky-top my-2 px-2 py-4">
        <nav id="header" class="w-100 fixed-top" aria-label="Main navigation">
            {% if user.is_authenticated %}
            
            <div class="offcanvas-lg offcanvas-end flex-grow-1" id="bdNavbar" aria-labelledby="bdNavbarOffcanvasLabel">
                
                <div class="offcanvas-body p-4 pt-0 p-lg-0 my-0">
                    <ul class="navbar-nav flex-row flex-wrap bd-navbar-nav align-items-center">
                        <li class="nav-item col-6 col-lg-auto ijodidar-icon">
                            <a class="navbar-brand fw-medium" href="/home" style="color:#fd0303; font-size: x-large; padding-left: 5px;">IJodidar</a>
                        </li>
                        <li class="nav-item header-width {% if request.path == '/home' %}header-active{% endif %} active col-6 col-lg-auto align-items-center">
                            <a class="nav-link py-2 px-0 px-lg-2 d-flex flex-column align-items-center" href="/home" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Home');" rel="noopener">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-house-door-fill" viewBox="0 0 16 16">
                                    <path d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5"/>
                                </svg>
                                <span class="px-1 header-icon-name">Home</span>
                            </a>
                        </li>
                        
                        <li class="nav-item header-width {% if request.path == '/family' %}header-active{% endif %} active col-6 col-lg-auto align-items-center">
                            <a class="nav-link py-2 px-0 px-lg-2 d-flex flex-column align-items-center" href="/family" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Home');" rel="noopener">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                    <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5.784 6A2.24 2.24 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.3 6.3 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1zM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"/>
                                </svg>
                                <span class="px-1 header-icon-name">Find Jodidar</span>
                            </a>
                        </li>
                        <li class="nav-item header-width {% if '/profile' in request.path %}header-active{% endif %} active col-6 col-lg-auto align-items-center">
                            <a class="nav-link py-2 px-0 px-lg-2 d-flex flex-column align-items-center" href="/profile" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Home');" rel="noopener">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-pc-display" viewBox="0 0 16 16">
                                    <path d="M8 1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1zm1 13.5a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0m2 0a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0M9.5 1a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM9 3.5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 0-1h-5a.5.5 0 0 0-.5.5M1.5 2A1.5 1.5 0 0 0 0 3.5v7A1.5 1.5 0 0 0 1.5 12H6v2h-.5a.5.5 0 0 0 0 1H7v-4H1.5a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5H7V2z"/>
                                </svg>
                                <span class="px-1 header-icon-name">Blog</span>
                            </a>
                        </li>
                    </ul>
    
                    <ul class="navbar-nav flex-row flex-wrap ms-md-auto align-items-center" style="width: 35%;">
                        <li class="nav-item col-6 col-lg-auto w-100">
                            <form class="d-flex position-relative" role="search">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search search-icon" viewBox="0 0 16 16">
                                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                                </svg>
                                <input class="form-control me-2 ps-5" type="search" placeholder="Search Jodidar Profiles" aria-label="Search" readonly>
                            </form>        
                        </li>
                    </ul>

                    <ul class="navbar-nav flex-row flex-wrap ms-md-auto align-items-center">
                        <li class="nav-item header-width {% if request.path == '/birthday' %}header-active{% endif %} active col-6 col-lg-auto align-items-center">
                            <a class="nav-link py-2 px-0 px-lg-2 d-flex flex-column align-items-center" href="/birthday" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Home');" rel="noopener">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-chat-dots-fill" viewBox="0 0 16 16">
                                    <path d="M16 8c0 3.866-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7M5 8a1 1 0 1 0-2 0 1 1 0 0 0 2 0m4 0a1 1 0 1 0-2 0 1 1 0 0 0 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
                                </svg>
                                <span class="px-1 header-icon-name">Messaging</span>
                            </a>
                        </li>
                        <li class="nav-item header-width {% if request.path == '/gender' %}header-active{% endif %} active col-6 col-lg-auto align-items-center">
                            <a class="nav-link py-2 px-0 px-lg-2 d-flex flex-column align-items-center" href="/gender" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Home');" rel="noopener">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                                    <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414zM0 4.697v7.104l5.803-3.558zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586zm3.436-.586L16 11.801V4.697z"/>
                                </svg>
                                <span class="px-1 header-icon-name">Mails</span>
                            </a>
                        </li>

                        <li class="nav-item header-width {% if request.path == '/name' %}header-active{% endif %} active col-6 col-lg-auto align-items-center">
                            <a class="nav-link py-2 px-0 px-lg-2 d-flex flex-column align-items-center" href="/name" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Home');" rel="noopener">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-bell-fill" viewBox="0 0 16 16">
                                    <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
                                </svg>
                                <span class="px-1 header-icon-name">Notifications</span>
                            </a>
                        </li>

                        <li class="nav-item col-6 col-lg-auto px-lg-4 dropdown">
                        <button class="btn p-0 border-0 dropdown-toggle" 
                                id="bd-theme"
                                type="button"
                                data-bs-toggle="dropdown"
                                aria-expanded="false"
                                aria-label="Toggle theme"
                                style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; background: none;">
                            
                            {% set primary_image = current_user.profile_images | selectattr('is_primary', 'equalto', True) | first %}
                            {% if primary_image %}
                            <img src="{{ primary_image.image_url }}" 
                                alt="Profile image" 
                                style="width: 100%; height: 100%; object-fit: cover; display: block;">
                            {% else %}
                            <div style="width: 100%; height: 100%; background-color: #6c757d; display: flex; align-items: center; justify-content: center; color: white; font-size: 1rem;">
                                {{ current_user.first_name[0] }}{{ current_user.last_name[0] }}
                            </div>
                            {% endif %}
                        </button>

                        <!-- Dropdown menu -->
                        <div class="dropdown-menu dropdown-menu-end text-center align-items-center rounded-5 bg-light my-3 px-4"
                            style="width: 25rem;" aria-labelledby="bd-theme-text">
                            
                            <!-- Profile preview in dropdown -->
                            <div class="d-flex flex-column align-items-center mb-3">
                            {% if primary_image %}
                            <img src="{{ primary_image.image_url }}" 
                                alt="Profile image" 
                                class="rounded-circle" 
                                style="width: 64px; height: 64px; object-fit: cover;">
                            {% else %}
                            <div style="width: 64px; height: 64px; background-color: #6c757d; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                                {{ current_user.first_name[0] }}{{ current_user.last_name[0] }}
                            </div>
                            {% endif %}
                            </div>

                            <h4>Hi, {{ current_user.first_name }}</h4>

                            <div class="card rounded-5 mt-3 w-100" onclick="location.href='/home'" style="cursor: pointer;">
                            <div class="card-body">
                                <h5 class="card-title">Manage your IJodidar Account</h5>
                            </div>
                            </div>

                            <div class="card rounded-5 mt-3 w-100">
                            <div class="card-body border-bottom" onclick="location.href='/logout'" style="cursor: pointer;">
                                <h5 class="card-title">Sign out</h5>
                            </div>
                            </div>
                        </div>
                        </li>


                    </ul>
                </div>
            </div>
            {% else %}
            <div id="bdNavbar" class="offcanvas-lg offcanvas-end flex-grow-1 inline" aria-labelledby="bdNavbarOffcanvasLabel">
                <div class="offcanvas-header px-4 pb-0">
                  <h5 class="offcanvas-title text-white" id="bdNavbarOffcanvasLabel">IJodidar</h5>
                  <button
                    type="button"
                    class="btn-close btn-close-white"
                    data-bs-dismiss="offcanvas"
                    aria-label="Close"
                    data-bs-target="#bdNavbar"
                  ></button>
                </div>
              
                <div class="offcanvas-body p-4 pt-0 p-lg-0">
                  <hr class="d-lg-none text-white-50">
                  <ul class="navbar-nav d-flex flex-row align-items-center">
                    <li class="nav-item col-6 col-lg-auto ijodidar-icon">
                            <a class="navbar-brand fw-medium" href="/home" style="color:#fd0303; font-size: x-large; padding-left: 5px;">IJodidar</a>
                    </li>
                    <li class="nav-item me-4">
                      <a class="nav-link py-2 px-0 px-lg-2" href="/" rel="noopener">
                        Services
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              

            {% endif %}
        </nav>
    </header>
    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script>
        window.addEventListener("scroll", function () {
            let header = document.getElementById("header");
            if (window.scrollY > 1) { // When user scrolls 50px down
                header.classList.add("scrolled");
            } else {
                header.classList.remove("scrolled");
            }
        });
        document.addEventListener("DOMContentLoaded", function () {
            document.documentElement.scrollLeft = document.documentElement.scrollWidth;
        });

    </script>
        <div>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    {% if category =='error' %}
                        <div class="alert alert-danger alert-dismissable fade show">
                            {{ message}}
                            <button type="button" class="close" data-dismiss="alert">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    {% else %}
                        <div class="alert alert-success alert-dismissable fade show">
                            {{ message}}
                            <button type="button" class="close" data-dismiss="alert">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        {% endwith %}

                {% block content %}
                
                {% endblock %}    
        </div>

        
</body>
</html>